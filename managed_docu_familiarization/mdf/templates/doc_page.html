{% extends 'layout/_grid.html' %}
{% load static i18n user_tags %}

{% block title %}- MDF base template for users{% endblock title %}

{% block css %}
{% endblock css %}

{% block javascript %}
{% endblock javascript %}


{% block inline_javascript %}
  {% include 'part/datatables.html' with datatables_element_id='managed_docu_familiarization_table' search_panes_columns='[1]' fixed_columns='1' %}
{% endblock inline_javascript %}

{% block content %}

  <h1>Náhled dokumentu: {{ document.doc_name }}</h1>
  <!--<iframe src="https://drive.google.com/viewerng/viewer?url={{ document_url }}=en&pid=explorer&efh=false&a=v&chrome=false&embedded=true" frameborder="0">-->
  <iframe class="justify-content-center embed-responsive-item" src="https://docs.google.com/viewer?srcid={{document_google_id}}&pid=explorer&efh=false&a=v&chrome=false&embedded=true" width="100%" height="800px">
    Tento prohlížeč nepodporuje zobrazení PDF dokumentů.
      <a href="{{ document.doc_url }}">Stáhnout dokument</a>
  </iframe>
  <!--<iframe class="justify-content-center embed-responsive-item" src="{{ document_url }}" width="100%" height="800px">
    Tento prohlížeč nepodporuje zobrazení PDF dokumentů.
      <a href="{{ document.doc_url }}">Stáhnout dokument</a>
  </iframe>-->
  <div class="justify-content-center py-3 my-4">
  {% if category == 3 %}
    {% if accepted %}
      <p>Souhlas odeslán!</p>
    {% else %}
      <h2>Souhlas s dokumentem</h2>
      <form method="post">
        {% csrf_token %}
        <label>
            <input type="checkbox" name="consent" required id="timeSpent" value="0">
            Souhlasím s obsahem dokumentu
        </label>
        <br><br>
        <button type="submit" onclick="calculateTimeSpent()">Odeslat souhlas</button>
      </form>
    {% endif %}

    {% if message %}
        <p style="color: green;">{{ message }}</p>
    {% endif %}
  {% endif %}
  </div>
  <div class="justify-content-center py-3 my-4">
    <hr>
    <h3>Stáhnout dokument</h3>
    <p>
        Pokud si chcete dokument stáhnout, klikněte na následující odkaz:
    </p>
    <a href="{{ file_url }}" download>Stáhnout dokument</a>
    <hr>
    <p><a href="{% url 'mdf:base_page' %}">Zpět na seznam dokumentů</a></p>
  </div>

<script>
    let startTime = Date.now();

    function calculateTimeSpent() {
        let endTime = Date.now();
        let timeSpent = Math.floor((endTime - startTime) / 1000);
        document.getElementById('timeSpent').value = timeSpent;
    }
</script>


{% endblock content %}
